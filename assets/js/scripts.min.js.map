{"version":3,"sources":["scripts.js"],"names":["rox_woo_search","$","window","document","opts","ajaxTimer","ajax","get_results","data","callback","error_cb","clearTimeout","get","url","response","status","abort","jqXHR","$cartBtn","removeClass","each","fail","$form","$resultContainer","$searchBtn","$clearBtn","oldValue","$searchEl","process_ajax_error","remove_icon","find","$container","verb","rox_csrf","html","result","rox_error","process_search_response","$el","length","on","event","which","keyCode","value","this","val","trim","_data","extend","s","remove","indexOf","hasClass","rox_loading","addClass","rox_ajax","click","preventDefault","blur","not","text","$item","closest","_nonce","focus","icons","has_results","success","rox_tick","message","action","setTimeout","product_id","cartBtnText","target","prepend"],"mappings":"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","file":"scripts.min.js","sourcesContent":["/**\n * Rox WooCommerce Mega Scripts\n */\nvar rox_woo_search = rox_woo_search || {};\n;(function($, window, document, opts){\n    \"use strict\";\n    var ajaxTimer, ajax;\n\n    var get_results = function( url, data, callback, error_cb ){\n        clearTimeout(ajaxTimer);\n        if (ajax) {\n            ajax.abort();\n            ajax = false;\n        }\n        ajaxTimer = setTimeout(function() {\n            ajax = $.get( url, data, function(response, status) {\n                callback( response, status );\n            }).fail(function( jqXHR, status ) {\n                if( typeof( error_cb ) === 'function' ) error_cb( jqXHR, status );\n            });\n        }, 150);\n    };\n    var rox_wcms = function( searchEl) {\n        var $searchEl = $( searchEl ),\n\t        $container = $searchEl.closest('.rox-search-container'), // DOM Cache\n            $form = $container.find('form.rox-search'),\n            $resultContainer = $container.find( '.result-contents' ),\n            $searchBtn = $container.find( 'a.submit'),\n            $clearBtn = $container.find('a.reset'),\n\t        oldValue = '',\n            has_results = false,\n            data = {\n        \t\t\taction: opts.rox_action,\n                    verb: 'search',\n    \t\t        _nonce: opts.rox_csrf\n    \t\t},\n            process_search_response = function ( response, status ) {\n                if( response.success ) {\n                    $resultContainer.html(response.data.result);\n                } else {\n                    $resultContainer.html( '<p class=\"alert alert-warning\">' + opts.rox_error + '</p>' );\n                }\n            },\n            process_ajax_error = function( jqXHR, status ){\n                if( status !== 'abort' ) {\n                    $resultContainer.html( '<p class=\"alert alert-warning\">' + opts.rox_error + '</p>' );\n                }\n            },\n            remove_icon = function( $el ) {\n                if( $el.find('.rox-icon').length > 0 ) $el.find('.rox-icon').remove();\n            };\n        // Hide if result container is visible\n        if( $container.hasClass('open') ) {\n            $container.removeClass('open');\n        }\n        \n        $searchEl.on( 'keyup', function( event ) {\n            var keyCode = (event.which) ? event.which : event.keyCode,\n                ignoreKeys = [9, 13, 16, 17,18, 20, 27, 33, 34, 45, 47, 58, 64, 91, 92, 93, 96, 123, 127, 144],\n                value = $(this).val().trim(),\n                _data = $.extend( {}, data, { s: value } );\n            if ( ignoreKeys.indexOf(keyCode) === -1 && value.length > 0 && value !== oldValue ) {\n\t            oldValue = value;\n                $resultContainer.html(opts.rox_loading);\n                if( ! $container.hasClass('open') ) {\n                    $container.addClass('open');\n                }\n                get_results( opts.rox_ajax, _data, process_search_response, process_ajax_error );\n            }\n        });\n        $searchEl.on('focus', function () {\n            if( $(this).val().length > 0 ) {\n                $container.addClass('open');\n            }\n        });\n        $form.on( 'keypress', function( event ) {\n\t        var keyCode = (event.which) ? event.which : event.keyCode;\n            if ( keyCode === 13 ) {\n                event.preventDefault();\n                return false;\n            }\n        }).on( 'keyup', function( event ) {\n\t        var keyCode = (event.which) ? event.which : event.keyCode;\n\t        if ( keyCode === 27 ) {\n\t\t        if( $container.hasClass('open') ) {\n\t\t\t        $container.removeClass('open');\n\t\t\t        oldValue = '';\n\t\t        }\n            }\n        });\n        $searchBtn.click(function (event) {\n            event.preventDefault();\n\t\t\tvar value = $searchEl.val(),\n            \t_data = $.extend( {}, data, { s: value } );\n            if( value.length > 0 ) {\n                $resultContainer.html(opts.rox_loading);\n                if( ! $container.hasClass('open') ) {\n                    $container.addClass('open');\n                }\n                get_results( opts.rox_ajax, _data, process_search_response );\n            } else {\n\t            $searchEl.focus();\n            }\n        });\n        $clearBtn.click(function (event) {\n            event.preventDefault();\n            $container.removeClass('open');\n            $searchEl.val('');\n            $resultContainer.html('');\n            has_results = false;\n\t        oldValue = '';\n\t        $searchEl.blur();\n        });\n\t    $container.on('click', '.rox-wcms-item.simple a.rox-wcms-cart', function(event){\n\t\t    event.preventDefault();\n\t\t    var $cartBtn = $(this),\n                cartBtnText = $cartBtn.find('span').not('.rox-icon').text(),\n                $item = $cartBtn.closest('.rox-wcms-item'),\n\t\t\t    data = {\n\t\t\t\t    action: opts.rox_action,\n\t\t\t\t    verb: 'add-to-cart',\n\t\t\t\t    _nonce: opts.rox_csrf,\n\t\t\t\t    product_id: $item.data('product_id'),\n\t\t\t    };\n\t\t    if( $cartBtn.hasClass('disabled') ) {\n\t\t\t    return false;\n\t\t    }\n\t\t    remove_icon( $cartBtn );\n\t\t    $cartBtn.addClass('disabled');\n\t\t    $cartBtn.prepend( opts.icons.rox_loading );\n\t\t    $.post( opts.rox_ajax, data, function( response ) {\n\t\t\t    remove_icon( $cartBtn );\n\t\t\t    if( response.success ) {\n\t\t\t\t    $item.addClass('in_cart');\n\t\t\t\t    $cartBtn.prepend( opts.icons.rox_tick );\n\t\t\t\t    $cartBtn.find('span').not('.rox-icon').text(response.data.message);\n\t\t\t    } else {\n\t\t\t\t    alert( response.data.message );\n\t\t\t\t    $cartBtn.removeClass('disabled');\n\t\t\t    }\n\t\t    } ).fail(function( jqXHR, status ) {\n\t\t\t    process_ajax_error( jqXHR, status );\n\t\t    }).always(function () {\n                setTimeout(function () {\n\t                remove_icon( $cartBtn );\n\t                $cartBtn.find('span').not('.rox-icon').text(cartBtnText);\n\t                $cartBtn.removeClass('disabled');\n                }, 2500 );\n\t\t    });\n\t    });\n\t    $(document).on('click', function( event ) {\n\t    \tvar $target = $( event.target );\n\t    \tif( $target.parents('.rox-search-container').length == 0 ) {\n\t\t\t    if( $container.hasClass('open') ) {\n\t\t\t\t    $container.removeClass('open');\n\t\t\t\t    if( $searchEl.val().trim() == '' ) oldValue = '';\n\t\t\t    }\n\t\t    }\n\t    });\n\t    $container.click(function(event){\n\t\t    // event.stopImmediatePropagation();\n\t\t    // event.stopPropagation();\n\t    });\n    };\n    $(document).ready(function(){\n\t    var $searchForm = $('.rox_wcm_search'); // DOM Cache\n\t    $searchForm.each( function () {\n\t\t    rox_wcms( this );\n\t    } );\n    });\n})(jQuery, window, document, rox_woo_search);"]}